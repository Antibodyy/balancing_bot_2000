# MPC Configuration Parameters
# Single source of truth per style_guide.md section 4.4

# Horizon parameters
prediction_horizon_steps: 4000
sampling_period_s: 0.02  

# Cost function weights (diagonal elements)
# State: [x, theta, psi, dx, dtheta, dpsi]
state_cost_diagonal:
  - 0.1      # x position - very low for velocity mode (position should drift freely)
  - 500.0    # theta (pitch) - highest priority for balance
  - 500   # psi (yaw/heading) - very low, let it drift based on yaw rate
  - 50.0     # dx (forward velocity)
  - 10.0     # dtheta (pitch rate)
  - 50.0      # dpsi (yaw rate) - VERY HIGH for circular motion tracking

# Control: [tau_L, tau_R]
control_cost_diagonal:
  - 0.01      # left wheel torque - reduced to allow more aggressive turning
  - 0.01      # right wheel torque - reduced to allow more aggressive turning

# Terminal cost computation
use_terminal_cost_dare: true
terminal_cost_scale: 1.0  # Scaling factor for terminal cost P (1.0 = no scaling)

# State constraints
pitch_limit_rad: 0.524              # 30 degrees
pitch_rate_limit_radps: 3.51         # approximately 286 deg/s sqrt((2*t_max*theta_max)/I_body_y)

# Terminal state constraints (at step N) - applied in addition to state constraints
terminal_pitch_limit_rad: null      # Force pitch to zero at terminal state (null to turn it off)
terminal_pitch_rate_limit_radps: null  # Force pitch rate to zero at terminal state

# Control constraints
control_limit_nm: 0.25              # Motor stall torque limit

# Solver settings
solver_name: 'osqp'
warm_start_enabled: true

# Online linearization settings
online_linearization_enabled: true  # Set to true to enable successive linearization at current state
